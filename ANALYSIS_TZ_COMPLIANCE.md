# Сравнительный анализ: Реализация vs ТЗ RW Group

**Дата анализа:** 2026-02-14
**Ветка:** master (commit 27a44e9)

---

## Общая оценка

| Категория | Реализовано | Частично | Не реализовано | Итого |
|-----------|:-----------:|:--------:|:--------------:|:-----:|
| Страницы и экраны | 9 | 1 | 0 | 10 |
| Формы заявок | 4 | 0 | 0 | 4 |
| Фильтры каталога | 5 | 0 | 0 | 5 |
| Сущности данных | 8 | 0 | 0 | 8 |
| Импорт фидов | 5 | 1 | 0 | 6 |
| SEO и аналитика | 4 | 2 | 2 | 8 |
| Админ-панель | 7 | 0 | 0 | 7 |
| Инфраструктура | 3 | 2 | 1 | 6 |
| **ИТОГО** | **45** | **6** | **3** | **54** |

**Общий процент соответствия: ~89%**

---

## ЧАСТЬ I. БИЗНЕС-ЛОГИКА И СТРУКТУРА

### 1. Страницы и маршруты

| # | Требование ТЗ | Маршрут | Статус | Комментарий |
|---|---------------|---------|--------|-------------|
| 1 | Главная (10 экранов) | `/` | **Реализовано** | Все 10 экранов присутствуют в `Home.tsx` |
| 2 | Каталог недвижимости | `/catalog` | **Реализовано** | Вкладки, фильтры, карточки — `Catalog.tsx` |
| 3 | Карточка лота | `/property/:id` | **Реализовано** | Галерея, параметры, CTA — `Property.tsx` |
| 4 | Карточка ЖК | `/complex/:id` | **Реализовано** | Параметры, лоты, карта — `Complex.tsx` |
| 5 | Страница подборки | `/collection/:id` | **Реализовано** | Обложка, описание, items — `Collection.tsx` |
| 6 | Политика конфиденциальности | `/privacy` | **Реализовано** | `Privacy.tsx` |
| 7 | Админ-панель | `/admin/*` | **Реализовано** | Полнофункциональная панель |

### 2. Единые элементы сайта

| Элемент | Требование ТЗ | Статус | Комментарий |
|---------|--------------|--------|-------------|
| **Header** | Логотип RWgroup | **Реализовано** | `Header.tsx` — SVG логотип |
| | Телефон +7 (495) 410-15-68 (кликабельный) | **Реализовано** | `tel:+74954101568` ссылка |
| | Адрес | **Реализовано** | "Москва, Кутузовский пр-т 36 А" |
| | Меню-якоря | **Реализовано** | Навигация по каталогам + якоря (#team, #catalog-categories) |
| | CTA "Получить консультацию" | **Реализовано** | Кнопка открывает `LeadModal` |
| **Footer** | Контакты | **Реализовано** | `Footer.tsx` |
| | Соцсети | **Реализовано** | Ссылки на соцсети |
| | Блог | **Частично** | Ссылка есть, но страница блога не реализована (не в скоупе ТЗ как отдельная страница) |
| | Политика конфиденциальности | **Реализовано** | Ссылка на `/privacy` |

### 3. Формы заявок (4 уникальные)

| # | Форма | Статус | Поля | Комментарий |
|---|-------|--------|------|-------------|
| 1 | Консультация | **Реализовано** | Имя + Телефон | `form_type: 'consultation'` |
| 2 | Купить / Продать | **Реализовано** | Вкладки + Имя + Телефон | `form_type: 'buy_sell'`, tabs: buy/sell |
| 3 | Записаться / Узнать детали | **Реализовано** | Имя + Телефон | `form_type: 'view_details'` |
| 4 | Стать партнёром | **Реализовано** | Имя + Телефон + Комментарий | `form_type: 'partner'` |

**Дополнительные требования к формам:**

| Требование | Статус | Комментарий |
|-----------|--------|-------------|
| Маска телефона | **Реализовано** | `formatPhoneRu()` в `LeadModal.tsx` |
| Согласие на ПДн | **Реализовано** | Чекбокс `consent` + ссылка на политику |
| Антиспам | **Реализовано** | Honeypot поле `company`, rate limiting |
| Фиксация источника | **Реализовано** | `source: { page, block, object_id, object_type }` |

### 4. Экраны главной страницы

| # | Экран | Статус | Комментарий |
|---|-------|--------|-------------|
| 1 | Hero (заставка) | **Реализовано** | Фон, заголовок "Эксперты по недвижимости", блок доверия "13 лет", слоган, 2 CTA кнопки |
| 2 | Каталоги недвижимости | **Реализовано** | 3 вкладки (Новостройки/Вторичка/Аренда), карточки категорий |
| 3 | Лучшие предложения + подборки | **Реализовано** | ЖК, лоты, коллекции из админки (`featured`) |
| 4 | Почему выбирают нас | **Реализовано** | 6 карточек преимуществ (выбор, подход, профессионализм, юр.чистота, безопасность, офис) |
| 5 | Стоимость услуг | **Реализовано** | Блоки стоимости + CTA |
| 6 | Этапы работы | **Реализовано** | 5 шагов (Roadmap компонент) |
| 7 | Миссия | **Реализовано** | Текст миссии и ценностей |
| 8 | Команда | **Реализовано** | Фото основателей (Анастасия и Александр Шулеповы), роли, история |
| 9 | Отзывы | **Реализовано** | Карточки отзывов с ссылками на источник |
| 10 | Стать партнёром | **Реализовано** | Описание + форма партнёрства |

---

## ЧАСТЬ II. ТЕХНИЧЕСКИЙ КОНТУР

### 5. Архитектура

| Требование ТЗ | Фактически | Статус | Комментарий |
|---------------|-----------|--------|-------------|
| Frontend: SPA/SSR (Next.js / аналог) | React 18 + Vite (SPA) | **Частично** | SPA реализовано, SSR отсутствует (SEO-ограничение) |
| Backend: REST API | Express.js REST API | **Реализовано** | Полнофункциональный REST API |
| БД: PostgreSQL | JSON file storage | **Частично** | Функционально работает, миграция на PostgreSQL запланирована |
| Админка: headless CMS / custom panel | Custom admin panel | **Реализовано** | Полная кастомная админка |
| Медиа: S3-совместимое хранилище | URL в массивах + локальные uploads | **Частично** | URL из фидов работают, S3 не подключено |
| CDN для изображений | Не реализовано | **Не реализовано** | Изображения раздаются напрямую |

### 6. Работа с фидами

| Требование | Статус | Комментарий |
|-----------|--------|-------------|
| Форматы: XLSX, CSV, XML, JSON | **Реализовано** | `xlsx`, `csv-parse`, `fast-xml-parser` в зависимостях |
| Ручная загрузка | **Реализовано** | `POST /api/admin/feed/upload` + Multer |
| Автообновление по URL (cron) | **Реализовано** | `feed-scheduler.ts`, поля `auto_refresh`, `refresh_interval_hours` |
| Маппинг колонок в админке | **Реализовано** | `AdminImport.tsx`, сохранение маппинга в `FeedSource.mapping` |
| Предпросмотр | **Реализовано** | `ImportPreview` тип, endpoint `/api/admin/import/preview` |
| Лог ошибок | **Реализовано** | `ImportRun.error_log`, `AdminLogs.tsx` |
| Сохранение шаблона импорта | **Частично** | Маппинг сохраняется в FeedSource, отдельная сущность ImportTemplate из ТЗ не реализована как отдельная таблица |

### 7. Сущности данных

| Сущность | Статус | Соответствие полям ТЗ |
|----------|--------|----------------------|
| Complex (ЖК) | **Реализовано** | Все обязательные + дополнительные поля. Расширено: `landing` конфиг, `slug`, `description` |
| Property (Лот) | **Реализовано** | Все обязательные поля + расширения: `floor`, `floors_total`, `renovation`, `old_price`, `area_living`, `area_kitchen` и др. |
| Collection (Подборка) | **Реализовано** | Все поля + расширения: `mode` (manual/auto), `auto_rules`, `status`, `slug` |
| Lead (Заявка) | **Реализовано** | Все поля + CRM-расширения: `lead_status`, `assignee`, `admin_note`, `ip`, `user_agent` |
| FeedSource | **Реализовано** | Все поля + `auto_refresh`, `refresh_interval_hours` |
| ImportRun | **Реализовано** | Все поля + `entity`, `feed_name`, `action` |
| AdminUser | **Реализовано** | Не в исходном ТЗ, но реализовано (роли, permissions, hash пароля) |
| AuditLog | **Реализовано** | Не в исходном ТЗ, но реализовано (журнал аудита) |

### 8. Нормализация данных

| Правило | Статус | Комментарий |
|---------|--------|-------------|
| Спальни — только числом (0-4) | **Реализовано** | `bedrooms: number` в типах |
| Цена — только числом | **Реализовано** | `price: number` в типах |
| Район/метро — справочники | **Реализовано** | Фильтрация через `district`, `metro[]` |
| Статусы — фиксированный список | **Реализовано** | `RecordStatus = 'active' \| 'hidden' \| 'archived'` |

### 9. Обновления и жизненный цикл

| Требование | Статус | Комментарий |
|-----------|--------|-------------|
| external_id + source_id = ключ | **Реализовано** | Используется при импорте |
| Обновление при совпадении | **Реализовано** | `import-logic.ts` |
| Пропавшие → hidden/archived | **Реализовано** | `stats.hidden` в ImportRun |
| last_seen_at, updated_at | **Реализовано** | Оба поля в Complex и Property |

### 10. SEO и аналитика

| Требование | Статус | Комментарий |
|-----------|--------|-------------|
| ЧПУ (slug) URL | **Реализовано** | `slug` поле на Complex, Property, Collection. Маршруты: `/property/:id`, `/complex/:id`, `/collection/:id` |
| Meta / OpenGraph | **Реализовано** | `index.html` — title, description, og:title, og:description, og:image, og:type |
| Schema.org (RealEstateAgent) | **Не реализовано** | Нет JSON-LD разметки в коде |
| Sitemap | **Не реализовано** | Только `robots.txt`, sitemap.xml не генерируется |
| Robots.txt | **Реализовано** | `public/robots.txt` |
| Яндекс Метрика | **Реализовано** | Скрипт в `index.html` (через `VITE_YM_ID`) |
| Google Analytics 4 | **Реализовано** | Скрипт в `index.html` (через `VITE_GA_ID`) |
| События (клики, формы, фильтры) | **Реализовано** | `trackEvent()` в 8 файлах — клики, формы, навигация |

### 11. Медиа

| Требование | Статус | Комментарий |
|-----------|--------|-------------|
| Приём ссылок из фида | **Реализовано** | `images: string[]` — массивы URL |
| Локальное сохранение | **Частично** | Uploads директория есть, но изображения из фидов хранятся как внешние URL |
| Генерация превью | **Не реализовано** | Нет thumbnail generation |
| Fallback-изображение | **Реализовано** | Используется в карточках при отсутствии фото |

---

## ЧАСТЬ III. КРИТЕРИИ ПРИЁМКИ

| # | Критерий | Статус | Комментарий |
|---|---------|--------|-------------|
| 1 | Все формы работают и передают данные | **Выполнен** | 4 формы с валидацией, маской, consent, source tracking, антиспам |
| 2 | Фиды корректно импортируются | **Выполнен** | XLSX/CSV/XML/JSON, маппинг, предпросмотр, автообновление |
| 3 | Каталоги и фильтры стабильны | **Выполнен** | 3 вкладки, 5 фильтров, карточки, пагинация |
| 4 | Админка позволяет управлять витриной | **Выполнен** | 7 разделов админки, RBAC, аудит |
| 5 | Мобилка полностью рабочая | **Выполнен** | Responsive design, Drawer для мобильных фильтров, burger-меню |
| 6 | Аналитика фиксирует события | **Выполнен** | Yandex Metrika + GA4 + trackEvent в ключевых точках |

---

## Сводка расхождений с ТЗ

### Критические (влияют на бизнес)

Нет критических расхождений.

### Средние (рекомендуется реализовать)

| # | Пункт | Описание | Приоритет |
|---|-------|----------|-----------|
| 1 | **Schema.org разметка** | Нет JSON-LD с типом `RealEstateAgent` и `RealEstateListing`. Влияет на SEO в поисковых системах | Высокий |
| 2 | **Sitemap.xml** | Нет динамической генерации sitemap из объектов/ЖК/подборок. Влияет на индексацию | Высокий |
| 3 | **SSR/SSG** | ТЗ предполагает SSR (Next.js), реализовано как SPA (Vite). Ограничивает SEO для динамических страниц | Средний |
| 4 | **PostgreSQL** | ТЗ требует PostgreSQL (Supabase), реализовано JSON file storage. Ограничивает масштабируемость | Средний |

### Низкие (улучшения)

| # | Пункт | Описание |
|---|-------|----------|
| 1 | **CDN для изображений** | Не подключён CDN, изображения раздаются напрямую |
| 2 | **S3 хранилище** | Медиа не загружаются в S3, хранятся как внешние URL |
| 3 | **Генерация превью изображений** | Нет thumbnail generation для оптимизации загрузки |
| 4 | **Страница блога** | В footer есть ссылка на блог, но страница не реализована (не является требованием ТЗ) |

---

## Реализовано сверх ТЗ (бонус)

Следующие функции реализованы, но **не были требованиями** исходного ТЗ:

1. **RBAC-система** — 4 роли администраторов (owner, content, import, sales) с 20+ гранулярными permissions
2. **Аудит-логи** — журнал всех действий администраторов
3. **CRM для лидов** — статусы заявок (new/in_progress/done/spam), назначение, заметки
4. **Автоматические подборки** — коллекции с авто-правилами фильтрации (не только ручной режим)
5. **Лендинги ЖК** — кастомизируемые лендинги для каждого ЖК (цвета, теги, факты, планировки, ближайшие места)
6. **Карта Leaflet** — интеграция карт для ЖК с nearby places
7. **Геокодирование** — автоматическое определение координат через Nominatim
8. **Публикация изменений** — система draft/publish для контента
9. **Rate limiting** — защита API от злоупотреблений
10. **Docker + CapRover** — полная контейнеризация и деплой

---

## Рекомендации по приоритетам доработок

### Фаза 1 (SEO — высокий приоритет)
1. Добавить Schema.org JSON-LD разметку (`RealEstateAgent`, `RealEstateListing`, `ApartmentComplex`)
2. Реализовать динамическую генерацию `sitemap.xml` на сервере

### Фаза 2 (Инфраструктура — средний приоритет)
3. Миграция на PostgreSQL/Supabase (согласно архитектурному плану)
4. Рассмотреть переход на SSR (Next.js) или prerendering для SEO-критичных страниц

### Фаза 3 (Оптимизация — низкий приоритет)
5. Подключить S3-совместимое хранилище для медиа
6. Настроить CDN для изображений
7. Реализовать генерацию thumbnail'ов
